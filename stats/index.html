<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stats ‚Äî SB Burger Week 2026 Map</title>
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçî</text></svg>"
    />
    <script src="../config.js"></script>
    <script>
      document.title = "Stats ‚Äî " + THEME.eventName + " Map";
    </script>
    <link rel="stylesheet" href="stats.css" />
  </head>
  <body>
    <header>
      <div class="header-left">
        <h1 id="pageTitle">SB Burger Week 2026</h1>
        <span class="header-sub">Stats Dashboard</span>
      </div>
      <a class="back-link" id="backLink" href="/">Back to Map</a>
    </header>

    <main>
      <div class="leaderboard-section" id="activitySection">
        <h2>Activity</h2>
        <p class="leaderboard-hint">Total actions across all restaurants</p>
        <div class="summary-cards" id="summaryCards">
          <div class="card">
            <div class="card-value" id="totalViews">‚Äî</div>
            <div class="card-label">Views</div>
          </div>
          <div class="card">
            <div class="card-value" id="totalDirApple">‚Äî</div>
            <div class="card-label">Apple Maps</div>
          </div>
          <div class="card">
            <div class="card-value" id="totalDirGoogle">‚Äî</div>
            <div class="card-label">Google Maps</div>
          </div>
          <div class="card">
            <div class="card-value" id="totalWebsite">‚Äî</div>
            <div class="card-label">Website</div>
          </div>
          <div class="card">
            <div class="card-value" id="totalPhone">‚Äî</div>
            <div class="card-label">Phone</div>
          </div>
          <div class="card">
            <div class="card-value" id="totalInstagram">‚Äî</div>
            <div class="card-label">Instagram</div>
          </div>
          <div class="card">
            <div class="card-value" id="totalShares">‚Äî</div>
            <div class="card-label">Shares</div>
          </div>
          <div class="card">
            <div class="card-value" id="totalDeeplinks">‚Äî</div>
            <div class="card-label">Direct Links</div>
          </div>
        </div>
      </div>

      <div class="leaderboard-section" id="filterSection">
        <h2>Filter Usage</h2>
        <p class="leaderboard-hint">How often each filter button is tapped</p>
        <div class="filter-stats-grid" id="filterStatsGrid"></div>
      </div>

      <div class="leaderboard-section" id="leaderboardSection">
        <h2>Restaurant Leaderboard</h2>
        <p class="leaderboard-hint">
          Ranked by engagement score.
          <span class="scoring-toggle" id="scoringToggle">How is this calculated? <span class="toggle-arrow">&#x25BC;</span></span>
        </p>
        <div class="scoring-detail" id="scoringDetail">
          <p><strong>Score</strong> = (Directions + Phone) &times; 3 + (Direct Links + Shares) &times; 2 + (Website + Instagram + Views) &times; 1</p>
          <p><strong>3&times;</strong> Directions (Apple/Google Maps) &amp; Phone &mdash; strongest visit intent, someone is heading there or calling</p>
          <p><strong>2&times;</strong> Direct Links &amp; Shares &mdash; someone shared or followed a link, actively spreading the word</p>
          <p><strong>1&times;</strong> Website, Instagram &amp; Views &mdash; casual browsing and interest</p>
        </div>
        <div class="table-wrap">
          <table id="leaderboard">
            <thead>
              <tr>
                <th class="col-rank">#</th>
                <th class="col-name">Restaurant</th>
                <th class="col-num">Direct</th>
                <th class="col-num">Views</th>
                <th class="col-num">Apple</th>
                <th class="col-num">Google</th>
                <th class="col-num">Website</th>
                <th class="col-num">Phone</th>
                <th class="col-num">Instagram</th>
                <th class="col-num">Shares</th>
                <th class="col-num">Score</th>
              </tr>
            </thead>
            <tbody id="leaderboardBody"></tbody>
          </table>
        </div>
      </div>

      <p class="footer-note" id="footerNote">Loading data‚Ä¶</p>
    </main>

    <!-- Load data for AREA_COLORS -->
    <script>
      var __dataYearOverride =
        new URLSearchParams(window.location.search).get("year");
      (function () {
        var src;
        if (__dataYearOverride && /^\d{4}$/.test(__dataYearOverride)) {
          src = "../data-" + __dataYearOverride + ".js";
        } else {
          var live = THEME.dataLiveDate;
          if (!live || new Date() >= new Date(live + "T00:01:00")) {
            src = "../data-" + new Date().getFullYear() + ".js";
          } else {
            src = "../data.js";
          }
        }
        var err = __dataYearOverride
          ? ' onerror="window.location.replace(window.location.pathname)"'
          : "";
        document.write(
          '<script src="' + src + '"' + err + "></" + "script>"
        );
      })();
    </script>
    <script src="../trending.js"></script>
    <script src="stats.js"></script>
  </body>
</html>
